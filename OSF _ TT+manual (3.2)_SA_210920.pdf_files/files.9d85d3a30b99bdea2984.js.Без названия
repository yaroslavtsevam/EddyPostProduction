webpackJsonp([54],{868:function(n,e,a){a(869)},869:function(n,e,a){"use strict";function t(n,e){var a;return h.each(n.children,function(n,t){if(e.name===t.data.name)return a=w.buildTreeBeardUpload(t,{branch:t.data.branch}),!1}),a||w.buildTreeBeardUpload(n,{name:e.name,branch:n.data.branch})}function o(n,e){function a(){l.modal.dismiss()}function t(n){l.select(".modal-footer .btn-danger").html("<i> Deleting...</i>").removeClass("btn-danger").addClass("btn-default disabled"),h.ajax({url:w.buildTreeBeardDelete(n,{branch:n.data.branch,sha:n.data.extra.fileSha}),type:"DELETE",beforeSend:g.setXHRAuthorization}).done(function(e){l.deleteNode(n.parentID,n.id),l.modal.dismiss(),l.clearMultiselect()}).fail(function(e){l.modal.dismiss(),v.Utils.dismissToolbar.call(l),n.notify.update("Delete failed.","danger",void 0,3e3),l.clearMultiselect()})}function o(n){n.forEach(function(n){t(n)})}function i(){var n=e[0];if(n.data.permissions.edit){var o=m("div",[m("p.text-danger","This folder and ALL its contents will be deleted. This action is irreversible.")]),i=m("div",[m("span.btn.btn-default",{onclick:function(){a.call(l)}},"Cancel"),m("span.btn.btn-danger",{onclick:function(){t(n)}},"Delete")]);l.modal.update(o,i,m("h3.break-word.modal-title",'Delete "'+n.data.name+'"?'))}else n.notify.update("You don't have permission to delete this file.","info",void 0,3e3)}var l=this;if(1===e.length){if("folder"!==e[0].kind){var s=e[0].parent(),r=m("div",[m("p","This action is irreversible."),s.children.length<2?m("p","If a folder in Github has no children it will automatically be removed."):""]),d=m("div",[m("span.btn.btn-default",{onclick:function(){a()}},"Cancel"),m("span.btn.btn-danger",{onclick:function(){t(e[0])}},"Delete")]);e[0].data.permissions.edit&&l.modal.update(r,d,m("h3.break-word.modal-title",'Delete "'+e[0].data.name+'"?'))}"folder"===e[0].kind&&(e[0].open?i():l.updateFolder(null,e[0],i))}else{var c,u,f=!0,p=[],b=[];e.forEach(function(n,e,a){n.data.permissions.edit?p.push(n):(f=!1,b.push(n))}),f?(c=m("div",[m("p.text-danger","This action is irreversible."),p.map(function(n){return m(".fangorn-canDelete.text-success",n.data.name)})]),u=m("div",[m("span.btn.btn-default",{class:"text-default",onclick:function(){a()}},"Cancel"),m("span.btn.btn-danger",{class:"text-danger",onclick:function(){o.call(l,p)}},"Delete All")])):(c=m("div",[m("p","Some of these files can't be deleted but you can delete the ones highlighted with green. This action is irreversible."),p.map(function(n){return m(".fangorn-canDelete.text-success",n.data.name)}),b.map(function(n){return m(".fangorn-noDelete.text-warning",n.data.name)})]),u=m("div",[m("span.btn.btn-default",{class:"text-default",onclick:function(){a()}},"Cancel"),m("span.btn.btn-danger",{class:"text-danger",onclick:function(){o.call(l,p)}},"Delete Some")])),l.modal.update(c,u,m("h3.break-word.modal-title","Delete multiple files?"))}return!0}function i(n,e){n.data.branch=e;var a=n.data.urls.repo.lastIndexOf("/tree/"),t=n.data.urls.repo.substring(0,a+1);n.data.urls.repo=t+"tree/"+e,this.updateFolder(null,n)}function l(n){return w.buildTreeBeardMetadata(n,{ref:n.data.branch})}function s(n,e){var a=this;n.children.forEach(function(e){v.Utils.inheritFromParent(e,n,["branch"])}),v.Utils.setCurrentFileID.call(a,n,window.contextVars.node.id,window.contextVars.file),!e&&a.isMultiselected(a.currentFileID)&&v.Utils.scrollToFile.call(a,a.currentFileID)}function r(n){var e=this,a=new b(n.data.nodeUrl).segment("files").segment(n.data.provider).segment(n.data.path.substring(1)).search({branch:n.data.branch}).toString();-1!==k.indexOf(e.pressedKey)?window.open(a,"_blank"):window.open(a,"_self")}function d(n,e){var a=this;if(n.data.isAddonRoot&&!1===n.connected)return v.Utils.connectCheckTemplate.call(this,n);if(n.data.addonFullname){var t=g.urlParams();!n.data.branch&&t.branch&&(n.data.branch=t.branch);var o=n.data.branch||n.data.defaultBranch;return m("span",[m("github-name",n.data.name+" ("+o+")")])}return"file"===n.kind&&n.data.permissions.view?m("span",[m("github-name.fg-file-links",{onclick:function(){r.call(a,n)}},n.data.name)]):m("span",n.data.name)}function c(n){var e=this,a=(n.parent().parent(),[]);return a.push({data:"name",folderIcons:!0,filter:!0,custom:d}),"project-files"===e.options.placement&&(a.push({data:"size",sortInclude:!1,filter:!1,custom:function(){return n.data.size?g.humanFileSize(n.data.size,!0):""}}),a.push({data:"downloads",sortInclude:!1,filter:!1,custom:function(){return m("")}}),a.push({data:"version",filter:!1,sortInclude:!1,custom:function(){return m("")}})),"fileview"!==e.options.placement&&a.push({data:"modified",filter:!1,custom:function(){return m("")}}),a}function u(n){if(n.data.iconUrl)return m("img",{src:n.data.iconUrl,style:{width:"16px",height:"auto"}}," ")}function f(n){this.returnIndex(n.id)}function p(n,e,a){a&&(a.branch=e.parent().data.branch)}var m=a(4),h=a(0),b=a(57),v=a(20).Fangorn,w=a(86),g=a(1),k=[224,17,91,93],x={view:function(n,e,a){function t(n,e,a){n.stopPropagation(),window.location=w.buildTreeBeardDownload(e,{fileSha:e.data.extra.fileSha,branch:e.data.branch})}var l=e.treebeard,s=e.item,d=[];if("folder"===s.kind){var c=[];if(s.data.branches){s.data.branch=s.data.branch||s.data.defaultBranch;for(var u=0;u<s.data.branches.length;u++){var f=s.data.branches[u]===s.data.branch?"selected":"";c.push(m("option",{selected:f,value:s.data.branches[u]},s.data.branches[u]))}}s.data.addonFullname?d.push(m.component(v.Components.dropdown,{label:"Branch: ",onchange:function(n){i.call(l,s,n.target.value)},icon:"fa fa-external-link",className:"text-info"},c)):d.push(m.component(v.Components.button,{onclick:function(n){v.ButtonEvents._downloadZipEvent.call(l,n,s)},icon:"fa fa-download",className:"text-primary"},"Download as zip")),"fileview"!==l.options.placement&&(window.File&&window.FileReader&&s.data.permissions&&s.data.permissions.edit&&(d.push(m.component(v.Components.button,{onclick:function(n){v.ButtonEvents._uploadEvent.call(l,n,s)},icon:"fa fa-upload",className:"text-success"},"Upload"),m.component(v.Components.button,{onclick:function(n){l.toolbarMode(v.Components.toolbarModes.ADDFOLDER)},icon:"fa fa-plus",className:"text-success"},"Create Folder")),s.data.isAddonRoot||d.push(m.component(v.Components.button,{onclick:function(n){o.call(l,n,[s])},icon:"fa fa-trash",className:"text-danger"},"Delete Folder"))),s.data.addonFullname&&d.push(m.component(v.Components.button,{onclick:function(n){window.location=w.buildTreeBeardDownloadZip(s,{branch:s.data.branch})},icon:"fa fa-download",className:"text-primary"},"Download as zip"),m.component(v.Components.button,{onclick:function(n){window.open(s.data.urls.repo,"_blank")},icon:"fa fa-external-link",className:"text-info"},"Open")))}else"file"===s.kind&&"fileview"!==l.options.placement&&(d.push(m.component(v.Components.button,{onclick:function(n){t.call(l,n,s)},icon:"fa fa-download",className:"text-primary"},"Download")),s.data.permissions&&s.data.permissions.view&&d.push(m.component(v.Components.button,{onclick:function(n){r.call(l,s)},icon:"fa fa-file-o",className:"text-info"},"View")),s.data.permissions&&s.data.permissions.edit&&d.push(m.component(v.Components.button,{onclick:function(n){o.call(l,n,[s])},icon:"fa fa-trash",className:"text-danger"},"Delete")),s.data.permissions&&s.data.permissions.view&&!s.data.permissions.private&&d.push(m("a.text-info.fangorn-toolbar-icon",{href:s.data.extra.webView},[m("i.fa.fa-external-link"),m("span","View on GitHub")])));return s.data.provider&&!s.data.isAddonRoot&&s.data.permissions&&s.data.permissions.edit&&"fileview"!==l.options.placement&&d.push(m.component(v.Components.button,{onclick:function(){l.toolbarMode(v.Components.toolbarModes.RENAME)},icon:"fa fa-pencil",className:"text-info"},"Rename")),m("span",d)}};v.config.github={uploadUrl:t,lazyload:l,resolveRows:c,folderIcon:u,onUploadComplete:f,lazyLoadOnLoad:s,uploadSuccess:p,itemButtons:x,removeEvent:o}}},[868]);
//# sourceMappingURL=files.9d85d3a30b99bdea2984.js.map