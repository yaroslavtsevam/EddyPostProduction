webpackJsonp([53],{872:function(n,a,t){t(873)},873:function(n,a,t){"use strict";function e(n,a){return n.data.urls.repo.substring(0,n.data.urls.repo.indexOf("/tree/")+6)+a}function o(n){return void 0===n.data.branch?n.data.isAddonRoot?n.data.default_branch:n.data.extra.branch:n.data.branch}function i(n,a){n.data.branch=a,this.updateFolder(null,n)}function r(n){var a=o(n);return w.buildTreeBeardMetadata(n,{branch:a})}function c(n,a){var t=this;n.children.forEach(function(a){b.Utils.inheritFromParent(a,n,["branch"])}),b.Utils.setCurrentFileID.call(t,n,window.contextVars.node.id,window.contextVars.file),!a&&t.isMultiselected(t.currentFileID)&&b.Utils.scrollToFile.call(t,t.currentFileID)}function l(n){var a=this,t=o(n),e=new m(n.data.nodeUrl).segment("files").segment(n.data.provider).segment(n.data.path.substring(1)).search({branch:t}).toString();-1!==g.indexOf(a.pressedKey)?window.open(e,"_blank"):window.open(e,"_self")}function s(n,a){var t=this;if(n.data.isAddonRoot&&!1===n.connected)return b.Utils.connectCheckTemplate.call(this,n);if(n.data.addonFullname){var e=v.urlParams();!n.data.branch&&e.branch&&(n.data.branch=e.branch);var i=o(n);return h("span",[h("gitlab-name",n.data.name+" ("+i+")")])}return"file"===n.kind&&n.data.permissions.view?h("span",[h("gitlab-name.fg-file-links",{onclick:function(){l.call(t,n)}},n.data.name)]):h("span",n.data.name)}function d(n){var a=this,t=(n.parent().parent(),[]);return t.push({data:"name",folderIcons:!0,filter:!0,custom:s}),"project-files"===a.options.placement&&(t.push({data:"size",sortInclude:!1,filter:!1,custom:function(){return n.data.size?v.humanFileSize(n.data.size,!0):""}}),t.push({data:"downloads",sortInclude:!1,filter:!1,custom:function(){return h("")}}),t.push({data:"version",filter:!1,sortInclude:!1,custom:function(){return h("")}})),"fileview"!==a.options.placement&&t.push({data:"modified",filter:!1,custom:function(){return h("")}}),t}function u(n){if(n.data.iconUrl)return h("img",{src:n.data.iconUrl,style:{width:"16px",height:"auto"}}," ")}function f(n){this.returnIndex(n.id)}function p(n,a,t){t&&(t.branch=a.parent().data.branch)}var h=t(4),m=(t(0),t(57)),b=t(20).Fangorn,w=t(86),v=t(1),g=[224,17,91,93],x={view:function(n,a,t){function r(n,a,t){n.stopPropagation();var e=o(a);window.location=w.buildTreeBeardDownload(a,{branch:e})}var c=a.treebeard,s=a.item,d=[];if("folder"===s.kind){var u=[];if(s.data.branches){s.data.branch=o(s);for(var f=0;f<s.data.branches.length;f++){var p=s.data.branches[f]===s.data.branch?"selected":"";u.push(h("option",{selected:p,value:s.data.branches[f]},s.data.branches[f]))}}if(s.data.addonFullname&&d.push(h.component(b.Components.dropdown,{label:"Branch: ",onchange:function(n){i.call(c,s,n.target.value)},icon:"fa fa-external-link",className:"text-info"},u)),"fileview"!==c.options.placement&&s.data.addonFullname){var m=o(s);d.push(h.component(b.Components.button,{onclick:function(n){window.location=w.buildTreeBeardDownloadZip(s,{branch:s.data.branch})},icon:"fa fa-download",className:"text-primary"},"Download"),h.component(b.Components.button,{onclick:function(n){window.open(e(s,m),"_blank")},icon:"fa fa-external-link",className:"text-info"},"Open"))}}else"file"===s.kind&&"fileview"!==c.options.placement&&(d.push(h.component(b.Components.button,{onclick:function(n){r.call(c,n,s)},icon:"fa fa-download",className:"text-primary"},"Download")),s.data.permissions&&s.data.permissions.view&&d.push(h.component(b.Components.button,{onclick:function(n){l.call(c,s)},icon:"fa fa-file-o",className:"text-info"},"View")),s.data.permissions&&s.data.permissions.view&&!s.data.permissions.private&&d.push(h("a.text-info.fangorn-toolbar-icon",{href:s.data.extra.webView},[h("i.fa.fa-external-link"),h("span","View on GitLab")])));return h("span",d)}};b.config.gitlab={lazyload:r,resolveRows:d,folderIcon:u,onUploadComplete:f,lazyLoadOnLoad:c,uploadSuccess:p,itemButtons:x}}},[872]);
//# sourceMappingURL=files.646e4fc0eb42b41bb9f8.js.map